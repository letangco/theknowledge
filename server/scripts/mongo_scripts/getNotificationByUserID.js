function(e){var n=[],o=db.notifications.findOne({userID:e});if(null!==o){var t=[];o.notifyList.reverse().map(function(o){if(o.userSendID){var i=db.users.findOne({cuid:o.userSendID,active:1});if(i)d={cuid:i.cuid,avatar:i.avatar,fullName:i.fullName,userName:i.userName?i.userName:""};else d={}}else var d={avatar:"https://tesse.io/assets/images/logo.png",fullName:"Tesse"};var f=db.users.findOne({cuid:e,active:1});if(f)s={cuid:f.cuid,userName:f.userName?f.userName:""};else var s={};if(Object.getOwnPropertyNames(d).length>0)if(o.userInfo=d,o.userRecieve=s,"upVoteKnowledge"==o.notifyType||"commentKnowledgeAuthor"==o.notifyType||"commentKnowledgeUserVote"==o.notifyType||"commentKnowledgeUserComment"==o.notifyType||"adminDeleteKnowledge"==o.notifyType||"adminRejectKnowledge"==o.notifyType||"censorKnowledge"==o.notifyType)"adminDeleteKnowledge"==o.notifyType?(o.notifyInfo.knowledgeTitle=o.notifyInfo.content,n.push(o)):"adminRejectKnowledge"==o.notifyType?(u=db.knowledges.findOne({_id:ObjectId(o.notifyInfo.knowledgeId)}))&&(o.notifyInfo.knowledgeTitle=u.title,o.notifyInfo.knowledgeId=u.slug,n.push(o)):(u=db.knowledges.findOne({_id:ObjectId(o.notifyInfo.knowledgeId),state:"published"}))&&(o.notifyInfo.knowledgeTitle=u.title,o.notifyInfo.knowledgeId=u.slug,n.push(o));else if("commentReplyKnowledgeComment"==o.notifyType||"commentReplyKnowledgeAuthor"==o.notifyType){var l=db.comments.findOne({_id:ObjectId(o.notifyInfo.knowledgeId)});if(l){var u=db.knowledges.findOne({_id:ObjectId(l.knowledgeId),state:"published"});u&&(o.notifyInfo.comment=l.content,o.notifyInfo.knowledgeId=u.slug,n.push(o))}}else"appointmentComment"==o.notifyType||"appointment"==o.notifyType?db.appointments.findOne({cuid:o.notifyInfo.cuid})&&n.push(o):"follow"==o.notifyType?-1==t.indexOf(o.userSendID)&&(t.push(o.userSendID),n.push(o)):n.push(o)})}return n}